{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Perfume30{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            background-color:#000000; color: white; 
            background-image: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), 
                              url("https://images.unsplash.com/photo-1518531933037-91b2f5f229cc?auto=format&fit=crop&q=80&w=1920");
            background-attachment: fixed; background-size: cover; background-position: center;
        }
        .nav-link { position: relative; transition: all 0.3s ease; }
        .nav-link:hover::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 100%; height: 1px; background-color: white; }
        .mobile-menu { transform: translateX(-100%); transition: transform 0.3s ease-in-out; }
        .mobile-menu.open { transform: translateX(0); }
        .overlay { opacity: 0; visibility: hidden; transition: all 0.3s ease-in-out; }
        .overlay.active { opacity: 1; visibility: visible; }
        .hamburger span { display: block; width: 25px; height: 2px; background-color: white; margin: 5px 0; transition: 0.3s; }
    </style>
</head>
<body>
    <div id="overlay" class="overlay fixed inset-0 bg-black bg-opacity-70 z-40 md:hidden"></div>

    <div id="mobileMenu" class="mobile-menu fixed top-0 left-0 w-80 h-full bg-[#000000] z-50 md:hidden shadow-lg border-r border-white/10">
        <div class="p-6">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-lg font-bold">Parfume30</h2>
                <button id="closeMenu" class="hamburger"><span></span><span></span><span></span></button>
            </div>
            <nav class="space-y-6">
                <a href="/" class="block text-lg font-medium py-2 border-b border-white/10">ГЛАВНАЯ</a>
                {% for category in categories %}
                <a href="{% url 'main:catalog' category.slug %}" hx-get="{% url 'main:catalog' category.slug %}" hx-target="#main-content" hx-push-url="true" class="block text-lg font-medium py-2 border-b border-white/10">{{ category.name|upper }}</a>
                {% endfor %}
                <a href="{% url 'main:price_list' %}" hx-get="{% url 'main:price_list' %}" hx-target="#main-content" hx-push-url="true" class="block text-lg font-medium py-2 border-b border-white/10">ЦЕНЫ</a>
                <a href="{% url 'main:about' %}" hx-get="{% url 'main:about' %}" hx-target="#main-content" hx-push-url="true" class="block text-lg font-medium py-2 border-b border-white/10">О НАС</a>
            </nav>
        </div>
    </div>

    <header class="sticky top-0 z-30 bg-black/80 backdrop-blur-md border-b border-white/5">
        <div class="mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <button id="menuToggle" class="hamburger md:hidden"><span></span><span></span><span></span></button>
                <a href="/" class="flex items-center space-x-2">
                    <img src="{% static 'images/logo.png' %}" alt="Logo" class="h-12 sm:h-16">
                    <span class="text-xl font-bold">Perfume30</span>
                </a>
                <nav class="hidden md:flex space-x-8">
                    {% for category in categories %}
                    <a href="{% url 'main:catalog' category.slug %}" hx-get="{% url 'main:catalog' category.slug %}" hx-target="#main-content" hx-push-url="true" class="nav-link text-sm font-medium uppercase">{{ category.name }}</a>
                    {% endfor %}
                </nav>
                <div class="hidden md:flex items-center space-x-6">
                    <a href="{% url 'main:price_list' %}" hx-get="{% url 'main:price_list' %}" hx-target="#main-content" hx-push-url="true" class="nav-link text-sm font-medium uppercase">ЦЕНЫ</a>
                    <a href="{% url 'main:about' %}" hx-get="{% url 'main:about' %}" hx-target="#main-content" hx-push-url="true" class="nav-link text-sm font-medium uppercase">О НАС</a>
                    
                    <div id="search-slot" class="flex items-center">
                        <button hx-get="{% url 'main:catalog_all' %}?show_search=true" 
                                hx-target="#search-slot" 
                                hx-swap="innerHTML" 
                                class="text-sm font-medium uppercase hover:text-gray-300">ПОИСК</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div id="main-content">
        {% block content %}
            {% if product %}
                {% include 'main/product_detail.html' %}
            {% elif is_about %}
                {% include 'main/about.html' %}
            {% elif is_price_list %}
                {% include 'main/price_list.html' %}
            {% elif products %}
                {% include 'main/catalog.html' %}
            {% else %}
                <main class="mx-auto px-4 py-20 text-center">
                    <h2 class="text-4xl font-bold mb-8 uppercase tracking-widest">Perfume30</h2>
                    <div class="flex flex-wrap justify-center gap-6 max-w-2xl mx-auto">
                        {% for category in categories %}
                        <a href="{% url 'main:catalog' category.slug %}" hx-get="{% url 'main:catalog' category.slug %}" hx-target="#main-content" hx-push-url="true" class="flex-1 min-w-[250px] p-8 border border-white/20 hover:border-white transition-colors">
                            <h3 class="text-xl font-bold uppercase">{{ category.name }}</h3>
                        </a>
                        {% endfor %}    
                    </div>
                </main>
            {% endif %}
        {% endblock %}
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const menuToggle = document.getElementById('menuToggle');
            const closeMenu = document.getElementById('closeMenu');
            const mobileMenu = document.getElementById('mobileMenu');
            const overlay = document.getElementById('overlay');
            const toggle = () => {
                mobileMenu.classList.toggle('open');
                overlay.classList.toggle('active');
                document.body.style.overflow = mobileMenu.classList.contains('open') ? 'hidden' : '';
            };
            [menuToggle, closeMenu, overlay].forEach(el => el?.addEventListener('click', toggle));
            document.addEventListener('htmx:afterRequest', () => { if(mobileMenu.classList.contains('open')) toggle(); });
        });
    </script>
</body>
</html>