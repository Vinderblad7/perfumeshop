{% block content %}
<main class="mx-auto px-4 sm:px-6 lg:px-8 py-8" style="font-family: 'Inter', sans-serif;">
    
    <div class="mb-8">
        <nav class="text-sm">
            <a href="/" 
               class="nav-link text-gray-400 hover:text-white transition-colors uppercase tracking-widest text-[10px]">ГЛАВНАЯ</a>
            
            <span class="mx-2 text-gray-600">/</span>
            
            {% if product.category %}
            <a href="{% url 'main:catalog' product.category.slug %}" 
               hx-get="{% url 'main:catalog' product.category.slug %}" 
               hx-target="#main-content" 
               hx-push-url="true"
               class="nav-link text-gray-400 hover:text-white transition-colors uppercase tracking-widest text-[10px]">{{ product.category.name|upper }}</a>
            <span class="mx-2 text-gray-600">/</span>
            {% endif %}
            
            <span class="text-white tracking-widest text-[10px]">{{ product.name|upper }}</span>
        </nav>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
        
        <div class="flex flex-col items-center lg:items-end space-y-4">
            <div id="main-image-container" class="w-full max-w-md aspect-[3/4] bg-[#f3f3f3] flex items-center justify-center overflow-hidden rounded-sm relative">
                {% if product.main_image %}
                    <img src="{{ product.main_image.url }}" 
                         alt="{{ product.name }}" 
                         id="main-product-img"
                         class="h-[85%] w-auto object-contain transition-opacity duration-300">
                {% endif %}
            </div>

            {% if product.images.all %}
            <div class="w-full max-w-md grid grid-cols-4 gap-2">
                <div class="aspect-[3/4] bg-[#f3f3f3] cursor-pointer hover:opacity-80 flex items-center justify-center rounded-sm border border-transparent hover:border-white/40"
                     onclick="changeMainImage('{{ product.main_image.url }}')">
                    <img src="{{ product.main_image.url }}" class="h-[80%] w-auto object-contain">
                </div>
                {% for extra in product.images.all %}
                <div class="aspect-[3/4] bg-[#f3f3f3] cursor-pointer hover:opacity-80 flex items-center justify-center rounded-sm border border-transparent hover:border-white/40"
                     onclick="changeMainImage('{{ extra.image.url }}')">
                    <img src="{{ extra.image.url }}" class="h-[80%] w-auto object-contain">
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>

        <div class="flex flex-col space-y-8">
            <div class="border-b border-white/10 pb-6">
                <p class="text-[11px] text-gray-400 tracking-[0.3em] uppercase mb-2">{{ product.brand.name }}</p>
                <h1 class="text-3xl sm:text-4xl font-bold tracking-tight text-white uppercase leading-tight">
                    {{ product.name }}
                </h1>
            </div>

            {% if product.description %}
            <div>
                <h3 class="text-xs font-bold text-white tracking-widest uppercase mb-4">Описание</h3>
                <div class="text-sm text-gray-400 leading-relaxed max-w-prose font-light">
                    {{ product.description|linebreaks }}
                </div>
            </div>
            {% endif %}

            <div class="pt-4">
                <a href="https://t.me/Perfume_30" 
                   target="_blank" 
                   class="block w-full bg-white text-black py-4 text-[11px] font-bold tracking-widest hover:bg-gray-200 transition-colors uppercase text-center">
                    Связаться с менеджером
                </a>
            </div>
        </div>
    </div>
</main>

<style>
    .nav-link { position: relative; transition: all 0.3s ease; }
    .nav-link:hover::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 100%;
        height: 1px;
        background-color: white;
    }
</style>

<script>
    function changeMainImage(src) {
        const mainImg = document.getElementById('main-product-img');
        if (mainImg) {
            mainImg.style.opacity = '0';
            setTimeout(() => {
                mainImg.src = src;
                mainImg.style.opacity = '1';
            }, 150);
        }
    }
    // Скролл вверх при переходе (для HTMX)
    document.addEventListener('htmx:afterSwap', function() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });
</script>
{% endblock %}